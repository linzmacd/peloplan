{% extends 'base.html' %}

{% block title %}Workouts{% endblock %}

{% block body %}
<div class='row'>
  <div class='column'>
    <h1>Welcome to PeloPlan!</h1>
    <br>
  </div>
</div>
<div class='row'>
  <!-- Filters -->
  <div class='col-2'>
    <div id='filters-box' align='left'>
      <h2>Filter classes</h2>
      <form>
        <input type='hidden' id='workout-date' value={{ workout_date }}>
        <input type='hidden' id='sched-order' value={{ sched_order }}>
        <input type='hidden' id='filter-discipline' value={{ discipline }}>
        <div>
          Class Length:<br>
          <select name='duration' id='filter-duration'>
            <option value=''></option>
            <option value='300'>5 minutes</option>
            <option value='600'>10 minutes</option>
            <option value='900'>15 minutes</option>
            <option value='1200'>20 minutes</option>
            <option value='1800'>30 minutes</option>
            <option value='2700'>45 minutes</option>
            <option value='3600'>60 minutes</option>
            <option value='5200'>90 minutes</option>
          </select>
        </div>
        <div>
          <br>Instructor:<br>
          <select name='instructor' id='filter-instructor'>
            <option value=''></option>
            {% for instructor in instructors %}
            <option value={{ instructors[instructor] }}>{{ instructor }}</option>
            {% endfor %}
          </select>
        </div>
        <div>
          <br>Category:<br>
          <select name='category' id='filter-category'>
            <option value=''></option>
            {% for category in categories %}
            <option value={{ categories[category] }}>{{ category }}</option>
            {% endfor %}
          </select>
        </div>
        <div>
          <br>Bookmarked? <input type='checkbox' id='filter-bookmarked'> 
        </div>
        <div>
          <br>Already Taken? <input type='checkbox' id='filter-completed'> 
        </div>
        <!-- <div>
          <br>Keywords: <br> 
          <input type='text' name='keywords'>
        </div> -->
        <div>
          <br>Sort By:<br>
          <select name='duration' id='filter-sortby'>
            <option value='original_air_time'>Newest</option>
            <option value='top_rated'>Top Rated</option>
            <option value='popularity'>Most Popular</option>
            <!-- <option value='trending'>Trending</option> -->
            <option value='difficulty'>Hardest</option>
            <option value='easiest'>Easiest</option>
          </select>
        </div>
      </form>
    </div>
  </div>
  <!-- Search Results -->
  <div class='col-10'>
    <h2>Classes that match your search criteria</h2>
    <div id='query-results' align='left'>
      {% for result in results['data'] %}
      <div class='row align-items-center' style='padding: 5px; margin: 5px; border: 1px solid black'>
        <div class='col-4'>
          <img src="{{ result['image_url'] }}" height=170px>
        </div>
        <div class='col-5'>
          <h4>{{ result['title'] }}</h4>
          {% for instructor in results['instructors'] %}
            {% if instructor['id'] == result['instructor_id'] %}
              {{ instructor['name'].upper() }}<br>
            {% endif %}
          {% endfor %}
          {{ result['description'] }}<br>
          Total Riders: {{ '{:,}'.format(result['total_workouts']) }}<br> 
          Rating: {{'%.2f' | format(result['overall_rating_avg']*100) }}% 
                 ({{ result['overall_rating_count'] }} votes)<br>
          Difficulty: {{ '%.2f' | format(result['difficulty_rating_avg']) }}
                     ({{ result['difficulty_rating_count'] }} votes)<br>
        </div>
        <div class='col-2'>
          <button class='add-workout' value="{{ result['id'] }}"> Add to Calendar </button>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}

{% block js %}
<script src='/static/js/workouts.js'></script>
{% endblock %}